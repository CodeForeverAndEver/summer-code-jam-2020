<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<div id="app">
  <div id="terminal">
    <div id="terminal-window">
      <div id="terminal-output" v-html="response">
      </div>
    </div>
    <div id="terminal-input"> 
      ~ $ 
      <input type="text" 
        class="terminal-input-text" 
        autofocus="autofocus" 
        @keyup.enter="run_command" 
        @keyup.arrow-up="populate_previous"
        @keyup.arrow-down="populate_next"
        v-model="command"
      >
    </div>
  </div>

</div>


<script>
  var app = new Vue({
    delimiters: ['[[', ']]'],
    el: '#app',
    data: {
      command: '',
      previous_commands: [],
      current_command_num: 0,
      response: '',
    },

    methods: {
      populate_previous: function(){
        if(this.current_command_num < this.previous_commands.length){
          this.command = this.previous_commands[this.current_command_num];
          this.current_command_num += 1 
        }
      },

      populate_next: function(){
        if(this.current_command_num > 0){
          this.current_command_num -= 1
          this.command = this.previous_commands[this.current_command_num-1];
        }
      },

      run_command: function(){
        if(this.command == 'cls' || this.command == 'clear'){
          this.response = ''
        } else {
          axios.get(`/terminal/command?c=${this.command}`)
          .then(res =>{
            this.response = this.response + res.data + "<br>"
          }, (error) =>{
            console.log(error)
          }) 
        }
        this.previous_commands.unshift(this.command)
        this.command = ''
        this.current_command_num = 0
        console.log(this.previous_commands)
      }
    }
  });
</script>


<style scoped>
  #terminal {
    background-color: #000;
    width: 500px;
    height: 300px;
    color: #aaa;
    font: 1rem Inconsolate, monospace;
    padding-left: 6px;
    position: relative;
  }
  #terminal-window {
    height: 90%; 
    width: 98%; 
    display: flex; 
    align-items: flex-end;
  }
  #terminal-output{
    overflow-y: hidden;
    max-height: 270px;
  }
  .terminal-input-text{
    background-color: #000;
    color: #aaa;
    font: 1rem Inconsolate, monospace;
    border: 0px;
    width: 460px;
  }
  input:focus, textarea:focus, select:focus{
      outline: none;
  }
</style>

