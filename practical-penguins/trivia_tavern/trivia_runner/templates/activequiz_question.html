{% extends "base.html" %}
{% block content %}
{% load static %}
<script src="{% static 'countdowntimer.js' %}"></script>
<script>

  window.onload = function() {
    //hard coded to thirty seconds. Change this to the variable the host sets
    var display = document.querySelector('#time'),
        timer = new CountDownTimer(30);

    timer.onTick(format).onTick(restart).start();

    function restart() {
      if (this.expired()) {
        setTimeout(function() {
          display.textContent='Times up!'
          // make post request
          var url = "{% url 'activequiz' active_trivia_quiz.pk %}";
          var params = "times-up";
          var xhr = new XMLHttpRequest();
          xhr.open("POST", url, true);

          //Send the proper header information along with the request
          xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
          xhr.send(params);
      }, 1000);
      }
    }

    function format(minutes, seconds) {
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      display.textContent = minutes + ':' + seconds;
    }
  };
</script>
<div class="parchment-border ">
    <div class="row">
        <div class="col-md-12"><h1>Question {{ active_trivia_quiz.current_question_index }}:</h1></div>
    </div>
    <div class="row">
        <p> {{ cur_question.question_text }} </p>
    </div>
    <div>
      Next question in <span id="time"></span>
    </div>
    <div class="row justify-content-end">
        <button type="submit" class="stamp is-draft" value="pause-timer">Pause Timer</button>
        {% include "trivia_next_step_btn.html" %}
    </div>
</div>
{% endblock %}
